test_that("LassoReg works", {
  expect_equivalent(LassoReg(X=matrix(c(0.4298961,-1.0152339,-0.7725549,-1.2733395,-1.16152146,1.458027153,0.51429236,0.88319006,-0.4412461,0.3443275,
                                        0.2584504,0.2769088,-0.8278393,0.8320593,-2.03905911,0.717417134,-1.57793731,-0.28235162,0.5756571,-0.1292314,
                                        1.0139199,0.9149687,1.2752355,-0.7535728,0.57441811,-0.009153604,-0.48131148,-1.48404709,0.9668471,-2.4747265,
                                        1.2641260,1.1353435,-0.7207329,-0.2868341,0.05846275,0.661199429,0.87989259,0.30715393,1.4235116,0.4224463,
                                        -0.2954836,-1.6217318,-0.9973066,0.5987567,0.80732695,-1.413589434,-1.24447888,-0.51310555,-0.8088376,0.5181848,
                                        -0.3131093,-0.7524346,0.3093103,0.8938899,-0.46254390,-1.225668208,0.68836532,1.75691846,0.5177848,-0.1947935,
                                        -1.7724168,0.9711965,0.7633666,0.3974758,0.26673154,0.898171907,1.41175125,-1.58335238,-0.7924749,0.4514147,
                                        0.2666917,-0.3769267,0.4037091,0.1330295,-1.08027657,-0.267798795,0.34101369,-0.75397856,1.3077607,0.1972633,
                                        0.8676918,0.6749937,-0.7005007,1.4990208,0.75045097,-0.825238125,-1.17269818,0.06028928,-1.1352083,0.2899268,
                                        -0.9564612,-1.2186129,-0.5399205,-1.8583104,0.05810840,1.383560144,-0.53182431,0.99845382,-1.4529758,0.9360601,
                                        0.7942273,1.2243573,2.1922002,-0.7932026,1.05256193,-0.693609132,-0.03074106,-0.03435284,0.5674335,-1.4026220,
                                        -1.5575322,-0.2128287,-0.3849668,0.6110272,1.17534040,-0.683318467,1.20367601,0.64518248,-0.7282520,1.0417499
                                        ),ncol = 10,byrow=TRUE),
                             y=  c(0.4955061,
                                  -0.1500556,
                                   0.9563488,
                                  -1.1315545,
                                   1.3480326,
                                   0.3396139,
                                  -2.0277679,
                                   0.9919465,
                                  -0.9070542,
                                  -0.4679587,
                                   0.6727052,
                                  -0.1197622),lambda=0.3,thresh = 1e-12,soft=TRUE), c(0.00000000,
                                                            -0.19882807,
                                                             0.00000000,
                                                             0.00000000,
                                                             0.00000000,
                                                            -0.07072009,
                                                             0.00000000,
                                                             0.00000000,
                                                             0.00000000,
                                                            -0.16803192),tolerance = .01)

  expect_equivalent(LassoReg(X=matrix(c(0.4298961,-1.0152339,-0.7725549,-1.2733395,-1.16152146,1.458027153,0.51429236,0.88319006,-0.4412461,0.3443275,
                                        0.2584504,0.2769088,-0.8278393,0.8320593,-2.03905911,0.717417134,-1.57793731,-0.28235162,0.5756571,-0.1292314,
                                        1.0139199,0.9149687,1.2752355,-0.7535728,0.57441811,-0.009153604,-0.48131148,-1.48404709,0.9668471,-2.4747265,
                                        1.2641260,1.1353435,-0.7207329,-0.2868341,0.05846275,0.661199429,0.87989259,0.30715393,1.4235116,0.4224463,
                                        -0.2954836,-1.6217318,-0.9973066,0.5987567,0.80732695,-1.413589434,-1.24447888,-0.51310555,-0.8088376,0.5181848,
                                        -0.3131093,-0.7524346,0.3093103,0.8938899,-0.46254390,-1.225668208,0.68836532,1.75691846,0.5177848,-0.1947935,
                                        -1.7724168,0.9711965,0.7633666,0.3974758,0.26673154,0.898171907,1.41175125,-1.58335238,-0.7924749,0.4514147,
                                        0.2666917,-0.3769267,0.4037091,0.1330295,-1.08027657,-0.267798795,0.34101369,-0.75397856,1.3077607,0.1972633,
                                        0.8676918,0.6749937,-0.7005007,1.4990208,0.75045097,-0.825238125,-1.17269818,0.06028928,-1.1352083,0.2899268,
                                        -0.9564612,-1.2186129,-0.5399205,-1.8583104,0.05810840,1.383560144,-0.53182431,0.99845382,-1.4529758,0.9360601,
                                        0.7942273,1.2243573,2.1922002,-0.7932026,1.05256193,-0.693609132,-0.03074106,-0.03435284,0.5674335,-1.4026220,
                                        -1.5575322,-0.2128287,-0.3849668,0.6110272,1.17534040,-0.683318467,1.20367601,0.64518248,-0.7282520,1.0417499
  ),ncol = 10,byrow=TRUE),
  y=  c(0.4955061,
        -0.1500556,
        0.9563488,
        -1.1315545,
        1.3480326,
        0.3396139,
        -2.0277679,
        0.9919465,
        -0.9070542,
        -0.4679587,
        0.6727052,
        -0.1197622),lambda=0.5,thresh = 1e-12,soft=TRUE), rep(0,10),tolerance = .01)

  expect_equivalent(LassoReg(X=matrix(c(1.0576862,0.30206181,	-1.1493681,	0.54087231,	0.06728945,	-2.1086440,	-0.5216067,	1.6681424,	-1.1830764,	-0.3228355,
                                        0.7002967,	-0.40759716,	0.8525360,	-0.02141596,	-0.49052900,	-0.2939689,	-0.2957628,	-0.5271273,	0.4005958,	-0.4567834,
                                        0.7761085,	0.06548666,	-0.1101893,	1.54034197,	0.21692811,	0.9169228,	0.4413254,	-0.3949121,	1.5382211,	-0.4341592,
                                        0.3338167,	-0.70707056,	-1.0766580,	-0.45830855,	-1.83815157,	0.5707163,	-1.1776140,	0.4569897,	0.2807179,	0.3030668,
                                        0.5963480	,0.18365014,	1.3346040,	-0.77362999,	1.33562001,	1.1023238	,1.6704523,	0.2360433,	-1.0957224,	-1.2763192,
                                        -1.6174263,	0.39080396,	-0.8288893,	-1.16547372	,-0.21600353,	0.1310969	,0.8998640,	-1.7298839,	-0.3751623,	1.3092545,
                                        -0.9263658,	-1.65105399,	1.1348803,	1.19605437,	1.19412865,	-0.2533774,	0.1779452,	0.6373904,	-0.6657390,	1.5961259,
                                        -0.9204640,	1.82371915	,-0.1569157	,-0.85844042,	-0.26928213,	-0.0650695,	-1.1946035,	-0.3466425,	1.1001654,	-0.7183500
  ),ncol = 10,byrow=TRUE),
  y=  c(-0.21834947,
        1.07117499,
        0.68334539,
      -0.26667966,
        0.88732563,
        0.02416683,
      -0.06566188,
       -2.11532182),lambda=0.1,thresh = 1e-12,soft=TRUE), c(0.4592959,
                                                           -0.3707915,
                                                            0.0000000,
                                                            0.0000000,
                                                            0.0000000,
                                                            0.0000000,
                                                            0.4343583,
                                                            -0.1833517,
                                                            0.0000000,
                                                            0.0000000),tolerance = .01)

  expect_equivalent(LassoReg(X=matrix(c(1.0576862,0.30206181,	-1.1493681,	0.54087231,	0.06728945,	-2.1086440,	-0.5216067,	1.6681424,	-1.1830764,	-0.3228355,
                                        0.7002967,	-0.40759716,	0.8525360,	-0.02141596,	-0.49052900,	-0.2939689,	-0.2957628,	-0.5271273,	0.4005958,	-0.4567834,
                                        0.7761085,	0.06548666,	-0.1101893,	1.54034197,	0.21692811,	0.9169228,	0.4413254,	-0.3949121,	1.5382211,	-0.4341592,
                                        0.3338167,	-0.70707056,	-1.0766580,	-0.45830855,	-1.83815157,	0.5707163,	-1.1776140,	0.4569897,	0.2807179,	0.3030668,
                                        0.5963480	,0.18365014,	1.3346040,	-0.77362999,	1.33562001,	1.1023238	,1.6704523,	0.2360433,	-1.0957224,	-1.2763192,
                                        -1.6174263,	0.39080396,	-0.8288893,	-1.16547372	,-0.21600353,	0.1310969	,0.8998640,	-1.7298839,	-0.3751623,	1.3092545,
                                        -0.9263658,	-1.65105399,	1.1348803,	1.19605437,	1.19412865,	-0.2533774,	0.1779452,	0.6373904,	-0.6657390,	1.5961259,
                                        -0.9204640,	1.82371915	,-0.1569157	,-0.85844042,	-0.26928213,	-0.0650695,	-1.1946035,	-0.3466425,	1.1001654,	-0.7183500
  ),ncol = 10,byrow=TRUE),
  y=  c(-0.21834947,
        1.07117499,
        0.68334539,
        -0.26667966,
        0.88732563,
        0.02416683,
        -0.06566188,
        -2.11532182),lambda=0.3,thresh = 1e-12,soft=TRUE), c(0.1467088,
                                                             -0.1503358,
                                                              0.0000000,
                                                             0.0000000,
                                                             0.0000000,
                                                             0.0000000,
                                                             0.2760314,
                                                             0.0000000,
                                                             0.0000000,
                                                             0.0000000),tolerance = .01)

  expect_equivalent(LassoReg(X=matrix(c(1.0576862,0.30206181,	-1.1493681,	0.54087231,	0.06728945,	-2.1086440,	-0.5216067,	1.6681424,	-1.1830764,	-0.3228355,
                                        0.7002967,	-0.40759716,	0.8525360,	-0.02141596,	-0.49052900,	-0.2939689,	-0.2957628,	-0.5271273,	0.4005958,	-0.4567834,
                                        0.7761085,	0.06548666,	-0.1101893,	1.54034197,	0.21692811,	0.9169228,	0.4413254,	-0.3949121,	1.5382211,	-0.4341592,
                                        0.3338167,	-0.70707056,	-1.0766580,	-0.45830855,	-1.83815157,	0.5707163,	-1.1776140,	0.4569897,	0.2807179,	0.3030668,
                                        0.5963480	,0.18365014,	1.3346040,	-0.77362999,	1.33562001,	1.1023238	,1.6704523,	0.2360433,	-1.0957224,	-1.2763192,
                                        -1.6174263,	0.39080396,	-0.8288893,	-1.16547372	,-0.21600353,	0.1310969	,0.8998640,	-1.7298839,	-0.3751623,	1.3092545,
                                        -0.9263658,	-1.65105399,	1.1348803,	1.19605437,	1.19412865,	-0.2533774,	0.1779452,	0.6373904,	-0.6657390,	1.5961259,
                                        -0.9204640,	1.82371915	,-0.1569157	,-0.85844042,	-0.26928213,	-0.0650695,	-1.1946035,	-0.3466425,	1.1001654,	-0.7183500
  ),ncol = 10,byrow=TRUE),
  y=  c(-0.21834947,
        1.07117499,
        0.68334539,
        -0.26667966,
        0.88732563,
        0.02416683,
        -0.06566188,
        -2.11532182),lambda=0.5,thresh = 1e-12,soft=TRUE), c( 0.00000000,
                                                               0.00000000,
                                                              0.00000000,
                                                            0.00000000,
                                                              0.00000000,
                                                               0.00000000,
                                                              0.06171012,
                                                              0.00000000,
                                                             0.00000000,
                                                               0.00000000),tolerance = .01)
  })
