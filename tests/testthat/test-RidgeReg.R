test_that("RidgeReg works", {
  expect_equivalent(RidgeReg(X=matrix(c( -0.37609340,  0.24193433, 0.9148240, -0.8342440, -0.73573391,
                             0.02706298,  0.57458040, -1.6266325 ,-1.4100575 ,-0.81883812,
                             1.45526689, -0.02515856, 1.4092311, -1.4976293  ,1.22980224,
                             0.49271925,  0.34580651, 0.2898341, -0.1369278, -0.52079868,
                            -1.76274149, -1.17070777, -2.2490611,  0.7677681, -2.05864681,
                              -0.56752957, -0.76589730 ,-1.4735324, -1.2527244,  0.26400570,
                             -0.09104561,0.92631003, -1.0942789 ,-0.2195265, -0.05921493,
                           -0.90885080, -0.65683633,  3.0163885 ,-0.4857332, -0.81742105),ncol = 5,byrow=TRUE),
                        y=  c(0.1710167,
                        -8.8371929,
                       -1.6762054,
                       -1.9095116,
                        3.2160443,
                        -3.0291179,
                        -4.5787770,
                        3.9737046),lambda=0.1), c(-0.5947234,
                                                  -2.7669950,
                                                   1.3684601,
                                                  2.6258604,
                                                   0.3282567),tolerance = .01)

  expect_equivalent(RidgeReg(X=matrix(c( -0.37609340,  0.24193433, 0.9148240, -0.8342440, -0.73573391,
                                         0.02706298,  0.57458040, -1.6266325 ,-1.4100575 ,-0.81883812,
                                         1.45526689, -0.02515856, 1.4092311, -1.4976293  ,1.22980224,
                                         0.49271925,  0.34580651, 0.2898341, -0.1369278, -0.52079868,
                                         -1.76274149, -1.17070777, -2.2490611,  0.7677681, -2.05864681,
                                         -0.56752957, -0.76589730 ,-1.4735324, -1.2527244,  0.26400570,
                                         -0.09104561,0.92631003, -1.0942789 ,-0.2195265, -0.05921493,
                                         -0.90885080, -0.65683633,  3.0163885 ,-0.4857332, -0.81742105),ncol = 5,byrow=TRUE),
                             y=  c(0.1710167,
                                   -8.8371929,
                                   -1.6762054,
                                   -1.9095116,
                                   3.2160443,
                                   -3.0291179,
                                   -4.5787770,
                                   3.9737046),lambda=0.5), c(-0.7282682,
                                                             -2.4324103,
                                                             1.3580619,
                                                             2.4874767,
                                                             0.3157418),tolerance = .01)

  expect_equivalent(RidgeReg(X=matrix(c( -1.37057542,	-0.6353406,	0.7825892,	0.01668857,	0.59457947,	0.7460157,	1.5685659,	-0.1334322,
                                         -0.18461398,	-0.2251750,	-1.2929037,	-0.89043754,	-0.55576304,	-0.2921836,	0.1586805,	-0.2433766,
                                         -0.37931528,	-1.0720919,	0.6930446	,0.40006880,	-0.48224376,	1.9595809,	2.2284166,	-0.8134316,
                                         0.40770497	,-1.0584750	,-0.1196033	,-1.45400787,	-0.04779677,	-0.2431579,	-0.4853917,	-0.9797936,
                                         -0.01766329,	-0.4970822,	-0.5826904,	0.51810752,	-1.11381102,	0.1420759,	-0.7497293,	0.6309866),ncol = 8,byrow=TRUE),
                             y=  c(0.94802362,
                                   -1.34184337,
                                   1.65032692,
                                  -1.92516476,
                                   0.05538003),lambda=0.5), c(-0.05722208,
                                                              0.21027720,
                                                              0.35643629,
                                                              0.69153055,
                                                              -0.01057380,
                                                              0.38565577,
                                                              0.31334066,
                                                              0.24794640),tolerance = .01)

  expect_equivalent(RidgeReg(X=matrix(c( -1.37057542,	-0.6353406,	0.7825892,	0.01668857,	0.59457947,	0.7460157,	1.5685659,	-0.1334322,
                                         -0.18461398,	-0.2251750,	-1.2929037,	-0.89043754,	-0.55576304,	-0.2921836,	0.1586805,	-0.2433766,
                                         -0.37931528,	-1.0720919,	0.6930446	,0.40006880,	-0.48224376,	1.9595809,	2.2284166,	-0.8134316,
                                         0.40770497	,-1.0584750	,-0.1196033	,-1.45400787,	-0.04779677,	-0.2431579,	-0.4853917,	-0.9797936,
                                         -0.01766329,	-0.4970822,	-0.5826904,	0.51810752,	-1.11381102,	0.1420759,	-0.7497293,	0.6309866),ncol = 8,byrow=TRUE),
                             y=  c(0.94802362,
                                   -1.34184337,
                                   1.65032692,
                                   -1.92516476,
                                   0.05538003),lambda=1), c( -0.077823283,
                                                              0.185934480,
                                                            0.334543764,
                                                            0.637601525,
                                                            -0.002048047,
                                                            0.360933995,
                                                            0.306934764,
                                                            0.232670222),tolerance = .01)

  expect_equivalent(RidgeReg(X=matrix(c( -0.37609340,  0.24193433, 0.9148240, -0.8342440, -0.73573391,
                                         0.02706298,  0.57458040, -1.6266325 ,-1.4100575 ,-0.81883812,
                                         1.45526689, -0.02515856, 1.4092311, -1.4976293  ,1.22980224,
                                         0.49271925,  0.34580651, 0.2898341, -0.1369278, -0.52079868,
                                         -1.76274149, -1.17070777, -2.2490611,  0.7677681, -2.05864681,
                                         -0.56752957, -0.76589730 ,-1.4735324, -1.2527244,  0.26400570,
                                         -0.09104561,0.92631003, -1.0942789 ,-0.2195265, -0.05921493,
                                         -0.90885080, -0.65683633,  3.0163885 ,-0.4857332, -0.81742105),ncol = 5,byrow=TRUE),
                             y=  c(0.1710167,
                                   -8.8371929,
                                   -1.6762054,
                                   -1.9095116,
                                   3.2160443,
                                   -3.0291179,
                                   -4.5787770,
                                   3.9737046),lambda=0), c(-0.5298193,
                                                           -2.8790818,
                                                           1.3688572,
                                                           2.6651509,
                                                           0.3163494),tolerance = .01)
  })
